#  S&P 500 Trading Strategies using Machine Learning

## Обзор Проекта
Данный проект направлен на разработку и тестирование финансовой торговой стратегии, использующей сигнал, генерируемый моделью машинного обучения, для достижения доходности, превышающей доходность индекса S&P 500. Проект охватывает полный цикл от обработки финансовых данных и генерации признаков до обучения моделей, кросс-валидации и бэктестинга стратегии.

##  Как Запустить Проект

1.  **Клонировать репозиторий:**
    ```bash
    git clone <URL_твоего_репозитория>
    cd SP500_strategies
    ```

2.  **Установить зависимости:**
    Убедитесь, что у вас установлен Python (рекомендуется 3.8+).
    ```bash
    pip install -r requirements.txt
    ```

3.  **Подготовка данных:**
    Файлы **`HistoricalPrices.csv`** (для индекса SP500) и `all_stocks_5yr.csv` (для отдельных акций) должны быть размещены в папке `data/`.

4.  **Порядок выполнения шагов:**
    Для выполнения всего пайплайна, запустите скрипты в следующем порядке:
    -   **Генерация признаков и целевой переменной:**
        ```bash
        python scripts/features_engineering.py
        ```
    -   **Кросс-валидация и поиск по сетке (Grid Search):**
        ```bash
        python scripts/gridsearch.py
        ```
    -   **Сбор метрик и важности признаков:**
        ```bash
        python scripts/model_selection.py
        ```
    -   **Генерация ML-сигнала (на основе CV):**
        ```bash
        python scripts/create_signal.py
        ```
    -   **Бэктестинг стратегии и генерация финального отчета:**
        ```bash
        python scripts/strategy.py
        ```

## Глобальный Подход (Прошедшее Время)

1.  **Обработка Данных и Признаки:** Финансовые данные были объединены, очищены и разделены на обучающую (Train) и тестовую (Test) выборки с учетом временного ряда (Test с 2017 года). Были сгенерированы технические индикаторы (Bollinger Bands, RSI, MACD), и было обеспечено **отсутствие утечки данных (no leakage)** путем правильного сдвига (shift) целевой переменной.
2.  **Машинное Обучение:** Была реализована временная кросс-валидация (`TimeSeriesSplit` с 10 фолдами и минимальной историей в 2 года). Модель (LightGBM) была обучена и оптимизирована с использованием поиска по сетке (Grid Search). Был выбран лучший пайплайн, и сгенерирован ML-сигнал, используя метод **Out-of-Fold (OOF)** предсказаний.
3.  **Бэктестинг Стратегии:** На основе ML-сигнала (вероятность роста) была реализована **Тернарная (Long/Short/Neutral) стратегия**. Стратегия была протестирована на исторических данных, и были рассчитаны ключевые метрики (PnL, Max Drawdown). Результаты представлены в отчете (`report.md`) и на графике в сравнении с индексом S&P 500.
